INSURANCE_API_IMAGE_NAME ?= insurance-db
INSURANCE_DB_NAME ?=  insurance
INSURANCE_DB_USERNAME ?= insurance
INSURANCE_DB_PASSWORD ?= insurance
INSURANCE_DB_PORT ?= 5432
INSURANCE_DB_HOST ?= insurance-db
INSURANCE_KAFKA_PORT ?= 9092
INSURANCE_KAFKA_HOST ?= kafka
INSURANCE_NETWORK ?= "insurance"
INSURANCE_INPUT_DATA_JSON_PATH ?= /application/static/rates.json
INSURANCE_JWT_SECRET ?= 58c16649230kl87rd7c2fa1615fcd744614a3c4ira18w1kv
INSURANCE_JWT_ALGORITHM ?= HS512
INSURANCE_JWT_ACCESS_TOKEN_EXPIRE_MINUTES ?= 43200

.PHONY: build
build:
	docker build -t $(INSURANCE_API_IMAGE_NAME) -f Dockerfile .

.PHONY: run
run:
	- docker network create $(INSURANCE_NETWORK)
	APP_NETWORK=$(INSURANCE_NETWORK) \
	APP_API_IMAGE_NAME=$(INSURANCE_API_IMAGE_NAME) \
    APP_DB_USERNAME=$(INSURANCE_DB_USERNAME) \
    APP_DB_PASSWORD=$(INSURANCE_DB_PASSWORD) \
    APP_DB_NAME=$(INSURANCE_DB_NAME) \
    APP_DB_PORT=$(INSURANCE_DB_PORT) \
    APP_DB_HOST=$(INSURANCE_DB_HOST) \
    APP_KAFKA_PORT=$(INSURANCE_KAFKA_PORT) \
    APP_KAFKA_HOST=$(INSURANCE_KAFKA_HOST) \
    APP_INPUT_DATA_JSON_PATH=$(INSURANCE_INPUT_DATA_JSON_PATH) \
    APP_API_JWT_SECRET=$(INSURANCE_JWT_SECRET) \
    APP_API_JWT_ALGORITHM=$(INSURANCE_JWT_ALGORITHM) \
    APP_API_JWT_ACCESS_TOKEN_EXPIRE_MINUTES=$(INSURANCE_JWT_ACCESS_TOKEN_EXPIRE_MINUTES) \
	docker-compose -f docker-compose.yaml up -d

